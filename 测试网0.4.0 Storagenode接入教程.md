# 配置 storagenode 
* [storagenode初始化](#storagenode初始化)
* [生成密钥](#生成密钥)
* [修改配置文件](#修改配置文件)
* [启动storagenode](#启动storagenode)


### storagenode初始化

如果创建存储节点已初始化，请忽略此步骤

```
./storagenode init 
```

### 生成密钥
请保持这个安全性
```
./storagenode keygen
```
### 修改配置文件
初始化storagenode后，默认生成配置文件~/.lamborage/config/node.toml，修改node.toml


```

[server]
# 服务启动绑定的地址
# 针对公网ip有限的情况，这里可以用内网地址，然后做端口转发接收目标地址是kad.external_address的请求
address = "1.2.3.4:13002"  

[kad]
# lambda 网络提供的DHT 种子节点地址
bootstrap_addr = "39.105.148.217:13000"  ## 可选dht地址：39.105.148.217:13000/47.94.129.97:13000/47.93.196.236:13000
# 节点注册到DHT网络的地址，这个必须是公网地址, 接收到的请求是由 绑定在server.address的服务处理的
external_address = "5.6.7.8:13000"

[gateway]
# 存储gateway服务启动绑定的地址, ./storagenode gateway 启动使用这个地址
# 针对公网ip有限的情况，这里可以用内网地址，然后做端口转发接收目标地址是gateway.external_address的请求
address = "0.0.0.0:9000"
# 存储节点对外声称的地址，这个必须是公网地址，接收到的请求是由 绑定在gateway.address的服务处理的
external_address = "5.6.7.8:9000" 
# gateway 配置文件目录
conf_dir = "/root/.lamborage/gateway"
# 数据存储目录
data_dir = "/root/.lamborage/store"
#挖矿数据存储目录
mining_dir = "/root/.lamborage/store/mining"

[message]
# storage_name为矿机名称machine-name；
storage_name = "machine-name" 
# MINER REST address
# miner节点启动的rest服务, 内网和公网IP都可以，如果miner-server跟storagenode都在内网可写内网IP
miner_address = "5.6.7.8:26670" 
```

### 启动storagenode

启动storagenode server和启动storagenode gateway。
```
nohup ./storagenode server >> sserver.out 2>&1 &
nohup ./storagenode gateway >> sgateway.out 2>&1 &
```

